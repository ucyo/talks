<!DOCTYPE html>
<html>
  <head>
    <title>Python packaging and dependency management</title>
    <meta charset="utf-8">
    <style>
      @import url(https://fonts.googleapis.com/css?family=Merriweather:400);
      @import url(https://fonts.googleapis.com/css?family=Montserrat:400,700,400italic);
      @import url(https://fonts.googleapis.com/css?family=Roboto:400,700,400italic);
    </style>
    <link rel="stylesheet" type="text/css" href="style.css" media="screen"/>
  </head>
  <body>
    <textarea id="source">


class: center, middle


# Poetry
## Python packaging and dependency management
Python Meeting IMK 

[2020/08/26]


---

# Why setting up environments?

- **Reproducibility** <br> The Python application should run everywhere as intended.
- **Dependency of projects** <br> Projects might use modules working only with specific versions 
- **Support more Python versions** <br> Projects running e.g. with `Python3.5`, `3.6`, ..., `2.7` .red[**:(**]
- **Isolation** <br> Starting with a blank sheet

How is the current field of Python dependency management? 
---

# Python Dependency Management

.center[<img src="https://imgs.xkcd.com/comics/python_environment.png" width=470>]

---

# Python **Interpreter** Vs. Python **Module** 

.left-column[
  ## Python versions
  
  Select which Python interpreter to use e.g. `python3.8`, `python2.7`,
  `python3.8.2`

  ```bash
  pyenv
  ```

  - Local installation of every possible Python version e.g pypy, (ana/mini)conda, jython
  - Simple switch per project/folder possible
]

.right-column[
  ## Module versions
  Define which library modules to use e.g. `numpy19.0.2`, `pandas1.2.4`, `xarray2.21.2` 

  ```bash
  poetry
  ```

  - Dependency management
  - Packaging to wheels/tars
  - Publishing to PyPI
  - Single configuration file
  ]

---

# Pyenv (Install/Uninstall)

*Download installer*
```bash
wget https://github.com/pyenv/pyenv-installer/raw/master/bin/pyenv-installer
```

*Install*
```bash
bash pyenv-installer
```

*Update*
```bash
pyenv update
```

*Uninstall*
```bash
rm -rf $(pyenv root)
```

---

# Poetry (Install/Uninstall)

*Download installer*
```bash
wget https://raw.githubusercontent.com/python-poetry/poetry/master/get-poetry.py
```

*Install*
```bash
python get-poetry.py
```

*Update itself*
```bash
poetry self update
```

*Uninstall*
```bash
python get-poetry.py --uninstall
```

---
# Poetry (Project creation)

*Create new environment*
```bash
poetry new awesome-demo
```
--
*Project folder structure*
```bash
awesome-demo
├── pyproject.toml
├── README.rst
├── awesome_demo
│   └── __init__.py
└── tests
    ├── __init__.py
    └── test_awesome_demo.py
```
---

# Poetry (Project creation)

Contents of `pyproject.toml`

```toml
[tool.poetry]
name = "awesome-demo"
version = "0.1.0"
description = ""
authors = ["Uğur Çayoğlu <Cayoglu@kit.edu>"]
[tool.poetry.dependencies]
python = "*"
[tool.poetry.dev-dependencies]
pytest = "^3.4"
```

`pytproject.toml` replaces all other setup files like:
- `setup.py` 
- `requirements.txt`
- `setup.cfg`
- `MANIFEST.in`
- `Pipfile`

---

# Poetry (Dependency management)

*Add dependency*
```bash
poetry add numpy pandas
```

*Add development dependency*
```bash
poetry add -D black
```
--
*Remove dependency*
```bash
poetry remove numpy
```
--
*Update dependencies to latest version*
```bash
poetry update
```
---
# Poetry (Environment creation and usage)

*Create environment*
```bash
poetry install
```

*Start CLI with environment*
```bash
poetry shell
```

---
# Poetry (Sharing)

*Build single file sources and wheel*
```bash
poetry build
```

*Publish code on PyPI*
```bash
poetry publish
```
---

# There are also other options

## Alternatives
- (Ana)conda <br> Environments incl. binaries
- venv
- virtualenv +virtualenvwrapper
- pipenv

## Additions
- pyenv <br> Python binary management

---

class: center, middle
background-image: url(Thats_all_folks.svg)
background-size: cover


    </textarea>
    <script src="https://remarkjs.com/downloads/remark-latest.min.js">
    </script>
    <script>
      var slideshow = remark.create({
        ratio: '4:3',
        highlightStyle: 'dracula',
        highlightLines: true,
      });
    </script>
  </body>
</html>

